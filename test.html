<!DOCTYPE html>
<html>
<head>
    <title>webOS HDMI Record Test</title>
    <style>
        body { background: #222; color: white; font-family: sans-serif; }
        /* The video element for HDMI input */
        #hdmi-source {
            width: 50%;
            height: 50%;
            background: #000;
            border: 2px solid #555;
        }
    </style>
</head>
<body>
    <h1>webOS HDMI 2 Viewer</h1>
    
    <!-- Your requested video tag -->
    <video id="hdmi-source" autoplay style="width:50%;height:50%">
        <source type="service/webos-external" src="ext://hdmi:2">
    </video>

    <div style="margin-top: 10px;">
        <button onclick="tryRecord()">Attempt Record (Will likely fail for HDMI)</button>
        <p id="status"></p>
    </div>

    <script>
        function tryRecord() {
            const videoElement = document.getElementById('hdmi-source');
            const status = document.getElementById('status');

            try {
                // captureStream() is required to record a video element
                // Note: Chrome 53 may require this to be enabled in flags
                const stream = videoElement.captureStream ? videoElement.captureStream() : videoElement.mozCaptureStream();
                
                const recorder = new MediaRecorder(stream);
                const chunks = [];

                recorder.ondataavailable = e => chunks.push(e.data);
                recorder.onstop = () => {
                    const blob = new Blob(chunks, { type: 'video/webm' });
                    const url = URL.createObjectURL(blob);
                    console.log("Blob URL created:", url);
                    status.innerHTML = "Blob URL created! (Check console)";
                };

                recorder.start();
                status.innerHTML = "Recording... (Stop in 3s)";
                
                setTimeout(() => recorder.stop(), 3000);
            } catch (err) {
                status.innerHTML = "Error: " + err.message + " (HDMI recording is blocked by webOS hardware)";
            }
        }
    </script>
</body>
</html>
